//-
//- caos-dashboard - CAOS dashboard
//-
//- Copyright Â© 2017 INFN - Istituto Nazionale di Fisica Nucleare (Italy)
//-
//- Licensed under the Apache License, Version 2.0 (the "License");
//- you may not use this file except in compliance with the License.
//- You may obtain a copy of the License at
//-
//-     http://www.apache.org/licenses/LICENSE-2.0
//-
//- Unless required by applicable law or agreed to in writing, software
//- distributed under the License is distributed on an "AS IS" BASIS,
//- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//- See the License for the specific language governing permissions and
//- limitations under the License.
//-
//-
//- Author: Fabrizio Chiarello <fabrizio.chiarello@pd.infn.it>
//-

.card
  .card-header
    .d-flex.justify-content-between
      .p-2(*ngIf="show_set_selector")
        p-dropdown([options]="sets", (onChange)="selected_set=$event.value", [autoWidth]="true", [style]="{'width': '100%'}")
      .p-2(*ngIf="show_daterange_selector")
        daterange((rangeChange)="date_range=$event")
      .p-2(*ngIf="show_granularity_selector")
        | Granularity:
        p-dropdown([options]="granularities", (onChange)="selected_granularity=$event.value")
      .p-2.dropdown
        button.btn.btn-secondary.dropdown-toggle(type="button", [popover]="settings_popover", placement="bottom", container="body", #pop="bs-popover")
          i.fa.fa-fw.fa-wrench
          | Settings

  .card-block
    div(*ngIf="fetching>=0")
      .progress
        .progress-bar([style.width.%]="fetching_percent")
      .row.justify-content-center
        | Loading data: {{ fetching_percent | number:'1.2-2' }}%

    nvd3([options]="options", [data]="data")

    .btn-toolbar(role="toolbar")
      .btn-group.mr-2(role="group")
        button.btn.btn-secondary(type="button", (click)="select_all()", tooltip="Click here to select all all series.") Select all
        button.btn.btn-secondary(type="button", (click)="deselect_all()", tooltip="Click here to deselect all series.") Deselect all
      // .btn-group(role="group")
      //   button.btn.btn-secondary(type="button", (click)="downloader.download_CSV('data.csv')", tooltip="Download raw data in CSV format.")
      //     | Download data
      //     i.fa.fa-fw.fa-download

    p Click on legend entries to cycle their visibility. To select a single series, double click on the legend entry.


ng-template(#settings_popover)
  .container-fluid
    .row
      .col-12
        label(for="linewidth_selector") Linewidth:
        p-dropdown#linewidth_selector([options]="linewidths", (onChange)="selected_linewidth=$event.value")
